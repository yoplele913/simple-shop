<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload Your File</title>
    <style>
        /* 스타일 설정 */
    </style>
</head>
<body>
    <div class="overlay">
        <h1>Upload Your File</h1>
        <p>Please select the image or video you wish to upload.</p>
        <input type="file" id="fileInput" />
        <button onclick="uploadFile()">Upload</button>
        <div id="message" class="message"></div>
    </div>

    <!-- AWS SDK for JavaScript를 포함 -->
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1039.0.min.js"></script>

    <script>
        async function uploadFile() {
            const file = document.getElementById('fileInput').files[0];
            const messageDiv = document.getElementById('message');
            
            if (!file) {
                messageDiv.textContent = "No file selected. Please choose a file.";
                messageDiv.style.color = "red";
                return;
            }

            try {
                messageDiv.textContent = "Uploading...";
                messageDiv.style.color = "white";

                // AWS 설정 초기화
                AWS.config.region = 'us-east-1'; // 예: us-east-1
                AWS.config.credentials = new AWS.CognitoIdentityCredentials({
                    IdentityPoolId: 'us-east-1:3cce83fd-2e15-48d2-9c0a-75246b816911'
                });

                // 자격 증명 로드
                AWS.config.credentials.get(function(err) {
                    if (err) {
                        console.error('Error loading credentials:', err);
                        return;
                    } else {
                        console.log('Credentials loaded successfully');

                        const s3 = new AWS.S3({
                            apiVersion: '2006-03-01',
                            params: { Bucket: 'uploadbucketb2o2' }
                        });

                        const params = {
                            Bucket: 'uploadbucketb2o2',
                            Key: file.name,
                            Body: file,
                            ContentType: file.type
                        };

                        s3.upload(params, function(err, data) {
                            if (err) {
                                console.error('Upload failed:', err);
                                messageDiv.textContent = "File upload failed. Error: " + err.message;
                                messageDiv.style.color = "red";
                            } else {
                                console.log('Upload succeeded:', data);
                                messageDiv.textContent = "File uploaded successfully!";
                                messageDiv.style.color = "green";
                            }
                        });
                    }
                });
            } catch (error) {
                console.error('Error in upload process:', error);
                messageDiv.textContent = "Error: " + error.message;
                messageDiv.style.color = "red";
            }
        }
    </script>
</body>
</html>

